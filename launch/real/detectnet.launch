<launch>
  <arg name="use_rviz" default="true" />
  <arg name="use_count_target_py" default="true" />
  <arg name="rviz_required" default="true" />
  <arg name="output" default="log" />
  <arg name="use_usb_cam" default="false"/>
  <arg name="device_id" default="1"/>
  <arg name="image_width" default="1920"/>
  <arg name="image_height" default="1080"/>
  <arg name="csv" default="true"/>
  <!-- screen -->
  <include if="$(arg use_usb_cam)" file="$(find oit_navigation_minibot_light_01)/launch/include/usb_cam.launch">
    <arg name="device_id" value="$(arg device_id)" />
    <arg name="image_width" value="$(arg image_width)" />
    <arg name="image_height" value="$(arg image_height)" />
  </include>
  <include unless="$(arg use_usb_cam)" file="$(find ros_deep_learning)/launch/video_source.ros1.launch">
    <arg name="input" value="csi://0" />
  </include>

  <!-- DETECTNET -->
  <arg name="model_name" default="ssd-mobilenet-v2"/>
  <arg name="model_path" default=""/>
  <arg name="prototxt_path" default=""/>
  <arg name="class_labels_path" default=""/>
  <arg name="input_blob" default=""/>
  <arg name="output_cvg" default=""/>
  <arg name="output_bbox" default=""/>
  <arg name="overlay_flags" default="box,labels,conf"/>
  <arg name="mean_pixel_value" default="0.0"/>
  <arg name="threshold" default="0.5"/>

  <node pkg="ros_deep_learning" type="detectnet" name="detectnet" output="$(arg output)">
    <remap from="/detectnet/image_in" to="/video_source/raw"/>
    <param name="model_name" value="$(arg model_name)"/>
    <param name="model_path" value="$(arg model_path)"/>
    <param name="prototxt_path" value="$(arg prototxt_path)"/>
    <param name="class_labels_path" value="$(arg class_labels_path)"/>
    <param name="input_blob" value="$(arg input_blob)"/>
    <param name="output_cvg" value="$(arg output_cvg)"/>
    <param name="output_bbox" value="$(arg output_bbox)"/>
    <param name="overlay_flags" value="$(arg overlay_flags)"/>
    <param name="mean_pixel_value" value="$(arg mean_pixel_value)"/>
    <param name="threshold" value="$(arg threshold)"/>
  </node>

  <include if="$(arg use_rviz)" file="$(find oit_navigation_minibot_light_01)/launch/include/rviz.launch">
    <arg name="file" value="detectnet" />
    <arg name="required" value="$(arg rviz_required)" />
  </include>

  <node if="$(arg use_count_target_py)" pkg="oit_navigation_minibot_light_01" name="count_target" type="count_target.py" output="screen">
    <param name="min_width" value="100"/>
    <param name="max_width" value="500"/>
    <param name="min_height" value="200"/>
    <param name="max_height" value="800"/>
    <!--width / height-->
    <param name="min_aspect" value="0.3"/>
    <param name="max_aspect" value="0.9"/>
    <param name="csv" value="$(arg csv)"/>
  </node>
</launch>
